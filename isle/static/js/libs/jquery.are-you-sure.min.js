!function(l){l.fn.areYouSure=function(e){var r=l.extend({message:"You have unsaved changes!",dirtyClass:"dirty",change:null,silent:!1,addRemoveFieldsMarksDirty:!1,fieldEvents:"change keyup propertychange input",fieldSelector:":input:not(input[type=submit]):not(input[type=button])"},e),a=function(e){if(e.hasClass("ays-ignore")||e.hasClass("aysIgnore")||e.attr("data-ays-ignore")||void 0===e.attr("name"))return null;if(e.is(":disabled"))return"ays-disabled";var t,i=e.attr("type");switch(e.is("select")&&(i="select"),i){case"checkbox":case"radio":t=e.is(":checked");break;case"select":t="",e.find("option").each(function(e){var i=l(this);i.is(":selected")&&(t+=i.val())});break;default:t=e.val()}return t},t=function(e){e.data("ays-orig",a(e))},n=function(e){var i=function(e){var i=e.data("ays-orig");return void 0!==i&&a(e)!=i},t=l(this).is("form")?l(this):l(this).parents("form");if(i(l(e.target)))o(t,!0);else{if($fields=t.find(r.fieldSelector),r.addRemoveFieldsMarksDirty)if(t.data("ays-orig-field-count")!=$fields.length)return void o(t,!0);var n=!1;$fields.each(function(){if($field=l(this),i($field))return!(n=!0)}),o(t,n)}},s=function(e){var i=e.find(r.fieldSelector);l(i).each(function(){t(l(this))}),l(i).unbind(r.fieldEvents,n),l(i).bind(r.fieldEvents,n),e.data("ays-orig-field-count",l(i).length),o(e,!1)},o=function(e,i){var t=i!=e.hasClass(r.dirtyClass);e.toggleClass(r.dirtyClass,i),t&&(r.change&&r.change.call(e,e),i&&e.trigger("dirty.areYouSure",[e]),i||e.trigger("clean.areYouSure",[e]),e.trigger("change.areYouSure",[e]))},d=function(){var e=l(this),i=e.find(r.fieldSelector);l(i).each(function(){var e=l(this);e.data("ays-orig")||(t(e),e.bind(r.fieldEvents,n))}),e.trigger("checkform.areYouSure")},u=function(){s(l(this))};return r.silent||window.aysUnloadSet||(window.aysUnloadSet=!0,l(window).bind("beforeunload",function(){if($dirtyForms=l("form").filter("."+r.dirtyClass),0!=$dirtyForms.length){if(navigator.userAgent.toLowerCase().match(/msie|chrome/)){if(window.aysHasPrompted)return;window.aysHasPrompted=!0,window.setTimeout(function(){window.aysHasPrompted=!1},900)}return r.message}})),this.each(function(e){if(l(this).is("form")){var i=l(this);i.submit(function(){i.removeClass(r.dirtyClass)}),i.bind("reset",function(){o(i,!1)}),i.bind("rescan.areYouSure",d),i.bind("reinitialize.areYouSure",u),i.bind("checkform.areYouSure",n),s(i)}})}}(jQuery);